<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>é—œå¡å¤©æ°£æ”»ç•¥ç«™ï½œä»Šæ—¥é—œå¡æŒ‡å—</title>

  <link rel="icon" type="image/png" href="./icon-overworld.png">
  <link rel="apple-touch-icon" href="./icon-overworld.png">
  <link rel="apple-touch-icon" sizes="180x180" href="./icon-overworld.png">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700;900&display=swap"
    rel="stylesheet">

  <style>
    :root {
      /* åƒç´ ä¸–ç•Œè‰²ç¥¨ */
      --ac-sky: #7EC0FF;
      --ac-sky-deep: #5BA3EB;
      --ac-cloud: #FFFFFF;

      --ac-ui: #FFF4D8;
      --ac-ui-soft: #FFE9B8;

      --ac-brick: #C95728;
      --ac-brick-dark: #8A3215;
      --ac-ground: #8B5A2B;

      --ac-flag-green: #2FAA4C;
      --ac-flag-dark: #1A7C34;

      --ac-text-main: #43220B;
      --ac-text-sub: #7A5A3A;

      --ac-pill-bg: #294A8C;
      --ac-pill-text: #FFFFFF;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: 'Zen Maru Gothic', sans-serif;
      color: var(--ac-text-main);
      min-height: 100vh;
      overflow-x: hidden;
      padding-bottom: 40px;

      /* å¤©ç©º + åœ°æ¿ */
      background:
        linear-gradient(to bottom,
          var(--ac-sky) 0%,
          var(--ac-sky-deep) 55%,
          var(--ac-ground) 55%,
          var(--ac-ground) 100%);
      position: relative;

      /* è‡ªè¨‚æ¸¸æ¨™ï¼šè«‹ç¢ºä¿æª”æ¡ˆå­˜åœ¨ */
      cursor: url('./cursor-adventurer.png') 4 4, auto;
    }

    /* å¤©ç©ºé›²æœµè£é£¾ */
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      pointer-events: none;
      background-image:
        radial-gradient(circle at 10% 20%, rgba(255, 255, 255, 0.9) 0, rgba(255, 255, 255, 0.9) 12px, transparent 13px),
        radial-gradient(circle at 35% 30%, rgba(255, 255, 255, 0.9) 0, rgba(255, 255, 255, 0.9) 14px, transparent 15px),
        radial-gradient(circle at 70% 18%, rgba(255, 255, 255, 0.9) 0, rgba(255, 255, 255, 0.9) 16px, transparent 17px),
        radial-gradient(circle at 80% 32%, rgba(255, 255, 255, 0.9) 0, rgba(255, 255, 255, 0.9) 14px, transparent 15px);
      opacity: 0.9;
      z-index: -2;
    }

    /* åº•éƒ¨ç£šå¡Šåœ°æ¿ */
    body::after {
      content: "";
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      height: 52px;
      background-image:
        linear-gradient(to top, var(--ac-brick-dark) 0, var(--ac-brick-dark) 8px, transparent 8px),
        repeating-linear-gradient(to right,
          var(--ac-brick) 0, var(--ac-brick) 24px,
          var(--ac-brick-dark) 24px, var(--ac-brick-dark) 26px);
      box-shadow: 0 -4px 0 #5B3417;
      z-index: 1;
    }

    /* é ‚éƒ¨ HUD */
    .status-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 16px;
      margin: 8px auto 0;
      max-width: 640px;
      border-radius: 16px;
      backdrop-filter: blur(10px);
      background: rgba(0, 0, 0, 0.18);
      border: 2px solid rgba(255, 255, 255, 0.7);
      box-shadow: 0 4px 0 rgba(0, 0, 0, 0.4);
      position: sticky;
      top: 8px;
      z-index: 10;
    }

    .status-left {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .brand-mini {
      font-size: 0.7rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: rgba(255, 255, 255, 0.85);
    }

    .location-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: var(--ac-flag-green);
      color: var(--ac-pill-text);
      padding: 4px 12px;
      border-radius: 999px;
      font-weight: 900;
      font-size: 0.95rem;
      border: 2px solid #ffffff;
      box-shadow: 0 3px 0 var(--ac-flag-dark);
    }

    .location-pill span {
      transform: translateY(0.5px);
    }

    .update-pill {
      font-size: 0.8rem;
      color: #F3F4FF;
      background: rgba(0, 0, 0, 0.4);
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.5);
      letter-spacing: 0.05em;
    }

    .container {
      padding: 16px 16px 40px;
      max-width: 640px;
      margin: 10px auto 0;
      position: relative;
      z-index: 2;
    }

    .brand-title {
      font-size: 1.6rem;
      font-weight: 900;
      color: #ffffff;
      text-shadow: 0 3px 0 rgba(0, 0, 0, 0.4);
      letter-spacing: 0.06em;
      margin-bottom: 4px;
    }

    .brand-subtitle {
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.92);
      margin-bottom: 20px;
    }

    /* === ä»Šæ—¥é—œå¡å¡ç‰‡ === */

    .hero-card {
      position: relative;
      background: var(--ac-ui);
      border-radius: 26px;
      padding: 22px 18px 20px;
      border: 3px solid var(--ac-brick-dark);
      box-shadow:
        0 5px 0 var(--ac-brick-dark),
        0 0 0 3px #fff6e2;
      overflow: hidden;
      transform-style: preserve-3d;
      will-change: transform;
    }

    .hero-period {
      position: absolute;
      top: -14px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--ac-pill-bg);
      color: var(--ac-pill-text);
      padding: 4px 18px;
      border-radius: 999px;
      font-weight: 900;
      font-size: 0.85rem;
      border: 2px solid #ffffff;
      box-shadow: 0 3px 0 rgba(0, 0, 0, 0.25);
      letter-spacing: 0.08em;
      text-transform: uppercase;
      white-space: nowrap;
    }

    .hero-layers {
      position: relative;
      height: 160px;
      margin-top: 10px;
      margin-bottom: 10px;
      overflow: visible;
    }

    .hero-layer {
      position: absolute;
      inset: 0;
      pointer-events: none;
      will-change: transform;
      transition: transform 0.12s ease-out;
    }

    .hero-bg-layer {
      background-image:
        linear-gradient(to top, #FFE3B3 0, #FFEFD0 50%, #FFF7E4 100%);
      border-radius: 18px;
      box-shadow: inset 0 0 0 2px rgba(255, 255, 255, 0.7);
      overflow: hidden;
    }

    .hero-bg-layer::before,
    .hero-bg-layer::after {
      content: "";
      position: absolute;
      width: 80px;
      height: 28px;
      background: #ffffff;
      border-radius: 18px;
      box-shadow:
        12px 4px 0 rgba(0, 0, 0, 0.06),
        0 0 0 2px rgba(255, 255, 255, 0.8);
      opacity: 0.7;
    }

    .hero-bg-layer::before {
      top: 12px;
      left: 18px;
    }

    .hero-bg-layer::after {
      top: 28px;
      right: 18px;
      width: 60px;
    }

    .hero-icon-layer {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .hero-icon-img {
      width: 88px;
      height: 88px;
      image-rendering: pixelated;
      filter: drop-shadow(0 4px 0 rgba(0, 0, 0, 0.22));
      animation: heroFloat 3s ease-in-out infinite;
    }

    @keyframes heroFloat {

      0%,
      100% {
        transform: translateY(0);
      }

      50% {
        transform: translateY(-6px);
      }
    }

    .hero-text-layer {
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 12px 14px;
    }

    .hero-world {
      font-size: 0.95rem;
      font-weight: 900;
      color: var(--ac-text-main);
      margin-bottom: 4px;
    }

    .hero-temp-container {
      display: flex;
      align-items: baseline;
      gap: 6px;
      margin-bottom: 6px;
    }

    .hero-temp {
      font-size: 3.1rem;
      font-weight: 900;
      color: var(--ac-text-main);
      line-height: 1;
      text-shadow: 0 2px 0 rgba(0, 0, 0, 0.16);
    }

    .hero-temp-unit {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--ac-text-sub);
    }

    .hero-desc {
      font-size: 0.95rem;
      color: var(--ac-text-sub);
      margin-bottom: 2px;
    }

    .hero-subdesc {
      font-size: 0.8rem;
      color: #a38454;
    }

    /* å»ºè­°å€ */

    .advice-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 12px;
      padding-top: 10px;
      border-top: 2px dashed #E4CDA6;
    }

    .advice-item {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 4px;
      background: rgba(255, 238, 201, 0.92);
      padding: 10px;
      border-radius: 16px;
      border: 2px solid #F5D29A;
      box-shadow: 0 3px 0 rgba(214, 162, 92, 0.9);
    }

    .advice-label {
      font-size: 0.75rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: #9A6C35;
    }

    .advice-core {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .advice-icon {
      font-size: 1.6rem;
    }

    .advice-text {
      font-size: 0.9rem;
      font-weight: 900;
      color: var(--ac-text-main);
      line-height: 1.3;
    }

    .advice-meta {
      font-size: 0.7rem;
      color: #9b7a4f;
      margin-top: 2px;
    }

    /* ç¨å¾Œé—œå¡ */

    .section-title {
      font-size: 1.05rem;
      color: #ffffff;
      margin: 22px 0 10px 4px;
      font-weight: 900;
      text-shadow: 0 2px 0 rgba(0, 0, 0, 0.4);
      letter-spacing: 0.06em;
    }

    .scroll-container {
      display: flex;
      overflow-x: auto;
      gap: 14px;
      padding-bottom: 8px;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .scroll-container::-webkit-scrollbar {
      display: none;
    }

    .mini-card {
      position: relative;
      min-width: 130px;
      background: var(--ac-ui);
      border-radius: 18px;
      padding: 12px 10px;
      border: 2px solid var(--ac-brick-dark);
      box-shadow: 0 4px 0 rgba(0, 0, 0, 0.35);
      flex-shrink: 0;
      transition: transform 0.18s ease-out, box-shadow 0.18s ease-out;
    }

    .mini-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 6px 0 rgba(0, 0, 0, 0.4);
    }

    .mini-time {
      display: inline-block;
      padding: 2px 10px;
      border-radius: 999px;
      background: var(--ac-pill-bg);
      color: var(--ac-pill-text);
      font-size: 0.72rem;
      font-weight: 800;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      margin-bottom: 8px;
    }

    .mini-icon-img {
      width: 40px;
      height: 40px;
      image-rendering: pixelated;
      margin-bottom: 4px;
      filter: drop-shadow(0 2px 0 rgba(0, 0, 0, 0.22));
    }

    .mini-temp {
      font-size: 0.98rem;
      font-weight: 800;
      color: var(--ac-text-main);
    }

    .mini-meta {
      font-size: 0.75rem;
      color: var(--ac-text-sub);
      margin-top: 4px;
    }

    /* Loading ç•«é¢ */

    .loading-screen {
      position: fixed;
      inset: 0;
      background:
        radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.4) 0, transparent 40%),
        radial-gradient(circle at 80% 30%, rgba(255, 255, 255, 0.35) 0, transparent 45%),
        linear-gradient(to bottom, var(--ac-sky) 0%, var(--ac-sky-deep) 60%, var(--ac-ground) 60%, var(--ac-ground) 100%);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 999;
    }

    .loading-icon {
      font-size: 3.6rem;
      filter: drop-shadow(0 4px 0 rgba(0, 0, 0, 0.25));
      animation: heroFloat 2.2s ease-in-out infinite;
    }

    .loading-text {
      color: #ffffff;
      font-weight: 700;
      margin-top: 18px;
      font-size: 0.98rem;
      text-shadow: 0 2px 0 rgba(0, 0, 0, 0.4);
      text-align: center;
      white-space: pre-line;
    }

    /* è¦–å·®å¡ç‰‡ï¼ˆæ¡Œæ©Ÿï¼‰ */
    @media (hover: hover) and (pointer: fine) {
      .hero-card {
        transition: transform 0.16s ease-out, box-shadow 0.16s ease-out;
      }
    }

    /* å°è¢å¹•å¾®èª¿ */
    @media (max-width: 360px) {
      .brand-title {
        font-size: 1.4rem;
      }

      .hero-temp {
        font-size: 2.7rem;
      }

      .hero-layers {
        height: 150px;
      }
    }
  </style>
</head>

<body>
  <!-- Loading ç•«é¢ -->
  <div id="loading" class="loading-screen">
    <div class="loading-icon">â­</div>
    <p id="loadingText" class="loading-text">æ­£åœ¨é‹ªç£šå¡Šâ€¦\nå·¥é ­é‚„åœ¨å–å’–å•¡ã€‚</p>
  </div>

  <!-- é ‚éƒ¨ HUD -->
  <div class="status-bar">
    <div class="status-left">
      <div class="brand-mini">é—œå¡å¤©æ°£æ”»ç•¥ç«™</div>
      <div class="location-pill">
        ğŸ®
        <span>ğŸ“ å°åŒ—</span>
      </div>
    </div>
    <div id="updateTime" class="update-pill">WORLD LOADINGâ€¦</div>
  </div>

  <!-- ä¸»å…§å®¹ -->
  <div class="container" id="mainContent" style="display: none;">
    <h1 class="brand-title">é—œå¡å¤©æ°£æ”»ç•¥ç«™</h1>
    <p class="brand-subtitle">æ¯å¤©å‡ºé–€å‰ï¼Œå…ˆçœ‹ä»Šå¤©æ˜¯è‰åœ°é—œã€æ°´åº•ä¸–ç•Œï¼Œé‚„æ˜¯ä¹¾è„†å¾…åœ¨åŸå ¡ã€‚</p>

    <div id="heroCard"></div>

    <h3 class="section-title">å¾ŒçºŒé—œå¡é å‘Š</h3>
    <div class="scroll-container" id="futureForecasts"></div>
  </div>

  <script>
    const API_URL = "https://cwaweather-backend01.zeabur.app/api/weather/kaohsiung";

    const ICON_SRC = {
      overworld: "./icon-overworld.png",
      water: "./icon-water.png",
      castle: "./icon-castle.png"
    };

    const LOADING_MESSAGES = [
      "æ­£åœ¨é‹ªç£šå¡Šâ€¦\nå·¥é ­é‚„åœ¨å–å’–å•¡ã€‚",
      "æ —å¯¶å¯¶åœ¨æ’éšŠå‡ºå ´ä¸­â€¦\nè«‹ç¨å€™æ’å®Œå†é–‹æ‰“ã€‚",
      "æ­£åœ¨æ’å¥½ä»Šæ—¥çµ‚é»æ——æ¡¿â€¦\nä¿è­‰ä¸æœƒæ’æ­ªã€‚",
      "é‡‘å¹£æ­£åœ¨æ…¢æ…¢æ’æˆä¸€æ¢å¥½æ’¿çš„è·¯ç·šâ€¦",
      "æ°£è±¡é˜¿å§¨æ­£åœ¨è·Ÿé—œå¡è¨­è¨ˆå¸«åµæ¶ï¼Œ\nç¨ç­‰ä»–å€‘åµå®Œã€‚"
    ];

    const ERROR_MESSAGES = [
      "å¤©æ°£è³‡æ–™è®€å–å¤±æ•—ï¼\n\nè¢«è·¯é‚Šçš„è˜‘è‡äººæ’åˆ°ï¼Œè³‡æ–™æ•´åŒ…æ‰é€²æ·±å‘è£¡äº† QQ\n\nè«‹é‡æ•´é—œå¡å¾Œå†è©¦ä¸€æ¬¡ã€‚",
      "è³‡æ–™æ‰é€²æ·±å‘è£¡äº†ï¼Œå‰›å‰›é‚£è·³æœ‰é»æ—©ã€‚\n\né‡æ•´é—œå¡ï¼Œå†è·³ä¸€æ¬¡çœ‹çœ‹ã€‚",
      "åº«å·´æš«æ™‚ä½”é ˜äº†æ°£è±¡å°ï¼Œè³‡æ–™è¢«é—œåœ¨åŸå ¡è£¡ QQ",
      "ç¶²è·¯æ°´ç®¡è¢«çƒé¾œå¡ä½äº†ï¼Œè«‹ç¨å¾Œå†é€šä¸€æ¬¡ç®¡ã€‚"
    ];

    function pickRandom(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    // å¤©æ°£ â†’ world key
    function getWorldKey(weather) {
      if (!weather) return "overworld";
      if (weather.includes("é›·")) return "castle";
      if (weather.includes("é›¨")) return "water";
      if (weather.includes("é™°")) return "castle"; // æœ‰é»å£“æŠ‘ï¼Œä¸Ÿå»åŸå ¡
      if (weather.includes("å¤šé›²")) return "overworld";
      if (weather.includes("æ™´")) return "overworld";
      return "overworld";
    }

    function getWorldIconSrc(weather) {
      const key = getWorldKey(weather);
      return ICON_SRC[key] || ICON_SRC.overworld;
    }

    // world åç¨±èˆ‡æç¬‘ tagline
    function getWorldInfo(weather) {
      const text = weather || "";
      let world = "æ™´ç©ºè‰åœ°é—œ";
      let tagline = "åƒ 1-1 è‰åœ°é—œä¸€æ¨£å–®ç´”ï¼Œä¸è¶ä»Šå¤©åˆ·ä¸€é»é€²åº¦èªªä¸éå»ã€‚";

      if (text.includes("é›·")) {
        world = "åº«å·´åŸå ¡é—œ";
        tagline = "é›·è²åƒåŸå ¡è£¡çš„ç«çƒï¼Œå‡ºé–€å‰è«‹ç¢ºèªè¡€é‡è·Ÿè£å‚™éƒ½æ»¿æ ¼ã€‚";
      } else if (text.includes("é›¨")) {
        world = "æ°´åº•ä¸–ç•Œé—œ";
        tagline = "åœ°é¢æ¿•åˆ°åƒæ°´é—œï¼Œå¸¶å‚˜ï¼è£å‚™äº†æ°´ä¸Šæ­¥è¡ŒæŠ€èƒ½ã€‚";
      } else if (text.includes("é™°")) {
        world = "åœ°åº•æ¢ç´¢é—œ";
        tagline = "å…‰ç·šæ˜æš—ï¼Œè‡ªå¸¶æ†‚é¬±æ¿¾é¡ï¼Œèº«ä¸ŠåŠ ä»¶å¤–å¥—æ¯”è¼ƒæœ‰å®‰å…¨æ„Ÿã€‚";
      } else if (text.includes("å¤šé›²")) {
        world = "é›²æœµè·³å°é—œ";
        tagline = "é›²æœµå¤šåˆ°åƒå¹³å°ï¼Œè…³æ»‘çš„äººå»ºè­°æ…¢æ…¢èµ°ã€‚";
      } else if (text.includes("æ™´")) {
        world = "æ™´ç©ºè‰åœ°é—œ";
        tagline = "è—å¤©ç™½é›²é‡‘è‰²å¤ªé™½ï¼ŒNPC éƒ½æœƒèªªã€ä»Šå¤©å¤©æ°£çœŸä¸éŒ¯å‘¢ã€çš„é‚£ç¨®ã€‚";
      }

      return { world, tagline };
    }

    // ç©¿æ­æç¬‘å»ºè­°
    function getAdvice(rainProb, maxTemp) {
      const rainValue = parseInt(rainProb, 10) || 0;
      const max = parseInt(maxTemp, 10) || 0;

      let rainIcon = "â­";
      let rainText = "è‰åœ°ä¸–ç•Œ Â· ä¸å¸¶å‚˜ä¹Ÿæ˜¯ä¸€ç¨®ä¿¡ä»°ã€‚";

      if (rainValue > 30) {
        rainIcon = "ğŸŒŠ";
        rainText = "æ°´åº•ä¸–ç•Œ Â· ä¸å¸¶å‚˜å°±æ˜¯é–‹å•Ÿé«˜é›£åº¦æ¨¡å¼ã€‚";
      }

      let clothIcon = "ğŸ‘Ÿ";
      let clothText = "æ¨™æº–è‰åœ°é—œå¡è£å‚™å°±å¥½ï¼Œé‡é»æ˜¯è¡Œèµ°é€Ÿåº¦ã€‚";

      if (max >= 28) {
        clothIcon = "ğŸ”¥";
        clothText = "åƒæ²™æ¼ ä¸–ç•Œï¼Œåšå¤–å¥—ç­‰æ–¼è‡ªå¸¶çƒ¤ç®±ï¼Œä¸å»ºè­°ã€‚";
      } else if (max <= 20) {
        clothIcon = "ğŸ§¥";
        clothText = "æ¥è¿‘åœ°åº•é—œé«”æ„Ÿï¼Œå¤–å¥—ï¼é˜²ç¦¦åŠ›ï¼‹1ã€‚";
      }

      return { rainIcon, rainText, clothIcon, clothText };
    }

    function getTimePeriod(startTime) {
      const hour = new Date(startTime).getHours();
      if (hour >= 5 && hour < 11) return "æ—©æ™¨é—œå¡";
      if (hour >= 11 && hour < 14) return "ä¸­åˆé—œå¡";
      if (hour >= 14 && hour < 18) return "ä¸‹åˆé—œå¡";
      if (hour >= 18 && hour < 23) return "æ™šä¸Šé—œå¡";
      return "æ·±å¤œé—œå¡";
    }

    // Hero è¦–å·®æ•ˆæœï¼ˆæ¡Œæ©Ÿï¼‰
    function initHeroParallax() {
      const supportsHover = window.matchMedia &&
        window.matchMedia("(hover: hover) and (pointer: fine)").matches;
      if (!supportsHover) return;

      const card = document.querySelector(".hero-card");
      if (!card) return;

      const layers = card.querySelectorAll(".hero-layer");
      if (!layers.length) return;

      const maxTilt = 6;
      const maxShift = 10;

      function handleMove(e) {
        const rect = card.getBoundingClientRect();
        const x = (e.clientX - rect.left) / rect.width - 0.5;
        const y = (e.clientY - rect.top) / rect.height - 0.5;

        const rotateX = y * -maxTilt;
        const rotateY = x * maxTilt;

        card.style.transform = `rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;

        layers.forEach((layer, index) => {
          const depth = (index + 1) / layers.length;
          const tx = -x * maxShift * depth;
          const ty = -y * maxShift * depth;
          layer.style.transform = `translate3d(${tx}px, ${ty}px, 0)`;
        });
      }

      function reset() {
        card.style.transform = "rotateX(0deg) rotateY(0deg)";
        layers.forEach(layer => {
          layer.style.transform = "translate3d(0,0,0)";
        });
      }

      card.addEventListener("mousemove", handleMove);
      card.addEventListener("mouseleave", reset);
    }

    function renderWeather(data) {
      const forecasts = data.forecasts;
      const current = forecasts[0];
      const others = forecasts.slice(1);

      const advice = getAdvice(current.rain, current.maxTemp);
      const period = getTimePeriod(current.startTime);
      const avgTemp = Math.round((parseInt(current.maxTemp) + parseInt(current.minTemp)) / 2);
      const worldInfo = getWorldInfo(current.weather);

      const heroCard = document.getElementById("heroCard");

      heroCard.innerHTML = `
        <div class="hero-card">
          <div class="hero-period">é—œå¡å¤©æ°£æ”»ç•¥ç«™ Â· ${period}</div>

          <div class="hero-layers">
            <div class="hero-layer hero-bg-layer"></div>

            <div class="hero-layer hero-icon-layer">
              <img class="hero-icon-img"
                   src="${getWorldIconSrc(current.weather)}"
                   alt="${worldInfo.world}">
            </div>

            <div class="hero-layer hero-text-layer">
              <div class="hero-world">ä»Šæ—¥é—œå¡ï¼š${worldInfo.world}</div>
              <div class="hero-temp-container">
                <div class="hero-temp">${avgTemp}</div>
                <div class="hero-temp-unit">Â°C</div>
              </div>
              <div class="hero-desc">${worldInfo.tagline}</div>
              <div class="hero-subdesc">å¤©æ°£åŸæ–‡ï¼š${current.weather}</div>
            </div>
          </div>

          <div class="advice-grid">
            <div class="advice-item">
              <div class="advice-label">ä»Šæ—¥ä¸–ç•Œ</div>
              <div class="advice-core">
                <div class="advice-icon">${advice.rainIcon}</div>
                <div class="advice-text">${advice.rainText}</div>
              </div>
              <div class="advice-meta">é™é›¨ç‡ ${current.rain}</div>
            </div>
            <div class="advice-item">
              <div class="advice-label">è£å‚™æç¤º</div>
              <div class="advice-core">
                <div class="advice-icon">${advice.clothIcon}</div>
                <div class="advice-text">${advice.clothText}</div>
              </div>
              <div class="advice-meta">æœ€é«˜æº« ${current.maxTemp}Â° Â· æœ€ä½æº« ${current.minTemp}Â°</div>
            </div>
          </div>
        </div>
      `;

      // å¾ŒçºŒé—œå¡
      const scrollContainer = document.getElementById("futureForecasts");
      scrollContainer.innerHTML = "";

      const todayDate = new Date().getDate();

      others.forEach(f => {
        const fDate = new Date(f.startTime);
        let label = getTimePeriod(f.startTime);
        const isTomorrow = fDate.getDate() !== todayDate;

        if (isTomorrow) {
          label = "æ˜æ—¥ Â· " + label.replace("é—œå¡", "");
        }

        const world = getWorldInfo(f.weather).world;
        const iconSrc = getWorldIconSrc(f.weather);

        scrollContainer.innerHTML += `
          <div class="mini-card">
            <div class="mini-time">${label}</div>
            <img class="mini-icon-img"
                 src="${iconSrc}"
                 alt="${world}">
            <div class="mini-temp">${f.minTemp}Â° - ${f.maxTemp}Â°</div>
            <div class="mini-meta">${world} Â· ğŸ’§${f.rain} Â· æƒ³å‡ºé–€è«‹è‡ªè¡Œè©•ä¼°é›£åº¦</div>
          </div>
        `;
      });

      // WORLD æ—¥æœŸ
      const now = new Date();
      const month = now.getMonth() + 1;
      const date = now.getDate();
      const dayIndex = now.getDay();
      const days = ["SUN", "MON", "TUE", "WED", "THU", "FRI", "SAT"];

      document.getElementById("updateTime").textContent =
        `WORLD ${month}-${date} Â· ${days[dayIndex]}`;

      initHeroParallax();
    }

    async function fetchWeather() {
      try {
        const delayPromise = new Promise(resolve => setTimeout(resolve, 1500));
        const fetchPromise = fetch(API_URL).then(res => res.json());

        const [, json] = await Promise.all([delayPromise, fetchPromise]);

        if (json.success) {
          renderWeather(json.data);
          document.getElementById("loading").style.display = "none";
          document.getElementById("mainContent").style.display = "block";
        } else {
          throw new Error("API Error");
        }
      } catch (e) {
        console.error(e);
        alert(pickRandom(ERROR_MESSAGES));
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      // éš¨æ©Ÿ Loading æ–‡å­—
      const loadingTextEl = document.getElementById("loadingText");
      if (loadingTextEl) {
        loadingTextEl.textContent = pickRandom(LOADING_MESSAGES);
      }

      fetchWeather();
    });
  </script>
</body>

</html>
